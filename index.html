<!DOCTYPE html>
<html>
<head>
<title>Hybrid Colour + Size Engine</title>
<style>
body{background:#111;color:#fff;font-family:Arial;text-align:center}
button{width:55px;height:55px;margin:4px;font-size:18px;border-radius:8px;border:none;cursor:pointer}
.controlBtn{width:120px;background:#444;color:white}
.meter{width:300px;height:20px;background:#333;border-radius:10px;margin:10px auto;overflow:hidden}
.fill{height:100%;width:0%;line-height:20px;font-size:12px;font-weight:bold}
#priority{margin-top:15px;font-size:18px;padding:10px;border-radius:8px}
</style>
</head>
<body>

<h2>SHORT TERM HYBRID ENGINE (Colour + Size)</h2>

<div id="buttons"></div>
<br>
<button class="controlBtn" onclick="undo()">UNDO</button>
<button class="controlBtn" onclick="resetAll()">RESET</button>

<div id="history"></div>
<div id="result"></div>

<h3>Hybrid Confidence</h3>
<div class="meter"><div id="confidenceBar" class="fill"></div></div>

<div id="priority"></div>

<script>

let history=[];
const MAX_HISTORY=15;

function getColor(n){
 if(n==0||n==5) return "Violet";
 if([1,3,7,9].includes(n)) return "Green";
 return "Red";
}
function getSize(n){
 return n<=4?"Small":"Big";
}

for(let i=0;i<=9;i++){
 let b=document.createElement("button");
 b.innerText=i;
 b.onclick=()=>addNumber(i);
 document.getElementById("buttons").appendChild(b);
}

function addNumber(n){
 history.push(n);
 if(history.length>MAX_HISTORY){
   history.shift();
 }
 updateDisplay();
 analyze();
}

function undo(){
 if(history.length>0){
   history.pop();
   updateDisplay();
   analyze();
 }
}

function resetAll(){
 history=[];
 document.getElementById("history").innerHTML="";
 document.getElementById("result").innerHTML="";
 document.getElementById("priority").innerHTML="";
 document.getElementById("confidenceBar").style.width="0%";
}

function updateDisplay(){
 document.getElementById("history").innerText=
 history.length>0?"History (Last 15): "+history.join(", "):"History Empty";
}

function analyze(){

 if(history.length<8){
   document.getElementById("result").innerText="Need minimum 8 results...";
   return;
 }

 let colorVotes={Red:0,Green:0,Violet:0};
 let sizeVotes={Big:0,Small:0};

 let recentColors=history.map(getColor);
 let recentSizes=history.map(getSize);

 let lastColor=recentColors[recentColors.length-1];
 let lastSize=recentSizes[recentSizes.length-1];

 // ===== COLOUR STREAK REVERSAL =====
 let colorStreak=1;
 for(let i=recentColors.length-2;i>=0;i--){
   if(recentColors[i]==lastColor) colorStreak++;
   else break;
 }
 if(colorStreak>=3){
   let reverse= lastColor=="Red"?"Green":
                lastColor=="Green"?"Red":"Red";
   colorVotes[reverse]+=3;
 }

 // ===== SIZE STREAK REVERSAL =====
 let sizeStreak=1;
 for(let i=recentSizes.length-2;i>=0;i--){
   if(recentSizes[i]==lastSize) sizeStreak++;
   else break;
 }
 if(sizeStreak>=3){
   let reverseSize= lastSize=="Big"?"Small":"Big";
   sizeVotes[reverseSize]+=3;
 }

 // ===== COLOUR MOMENTUM (last 6) =====
 let last6Colors=recentColors.slice(-6);
 let red6=last6Colors.filter(x=>x=="Red").length;
 let green6=last6Colors.filter(x=>x=="Green").length;

 if(red6>=4) colorVotes["Green"]+=2;
 if(green6>=4) colorVotes["Red"]+=2;

 // ===== SIZE MOMENTUM (last 6) =====
 let last6Sizes=recentSizes.slice(-6);
 let big6=last6Sizes.filter(x=>x=="Big").length;
 let small6=last6Sizes.filter(x=>x=="Small").length;

 if(big6>=4) sizeVotes["Small"]+=2;
 if(small6>=4) sizeVotes["Big"]+=2;

 // ===== COLOUR-SIZE CORRELATION =====
 let comboCount={};
 for(let i=0;i<history.length;i++){
   let combo=getColor(history[i])+"-"+getSize(history[i]);
   comboCount[combo]=(comboCount[combo]||0)+1;
 }

 let lastCombo=lastColor+"-"+lastSize;
 if(comboCount[lastCombo]>=3){
   colorVotes[lastColor]+=2;
   sizeVotes[lastSize]+=2;
 }

 // ===== VIOLET GAP =====
 let gap=0;
 for(let i=recentColors.length-1;i>=0;i--){
   if(recentColors[i]=="Violet") break;
   gap++;
 }
 if(gap>=7){
   colorVotes["Violet"]+=3;
 }

 // ===== FINAL DECISION =====
 let finalColor=Object.keys(colorVotes)
   .reduce((a,b)=>colorVotes[a]>colorVotes[b]?a:b);

 let finalSize=Object.keys(sizeVotes)
   .reduce((a,b)=>sizeVotes[a]>sizeVotes[b]?a:b);

 let totalColorVotes=colorVotes.Red+colorVotes.Green+colorVotes.Violet;
 let totalSizeVotes=sizeVotes.Big+sizeVotes.Small;

 let colorConfidence = totalColorVotes>0 ?
   (colorVotes[finalColor]/totalColorVotes) : 0;

 let sizeConfidence = totalSizeVotes>0 ?
   (sizeVotes[finalSize]/totalSizeVotes) : 0;

 let hybridConfidence=Math.round((colorConfidence+sizeConfidence)/2*100);

 document.getElementById("result").innerHTML=
 "<br>Next Prediction:<br>"+
 "Colour: <b>"+finalColor+"</b><br>"+
 "Size: <b>"+finalSize+"</b><br>"+
 "Hybrid Confidence: "+hybridConfidence+"%";

 let bar=document.getElementById("confidenceBar");
 bar.style.width=hybridConfidence+"%";
 bar.innerText=hybridConfidence+"%";
 bar.style.background="cyan";

 let priority=document.getElementById("priority");

 if(hybridConfidence>=75){
   priority.innerHTML="ðŸ”¥ STRONG HYBRID â†’ Play Colour + Size";
   priority.style.background="darkgreen";
 }
 else if(colorConfidence>sizeConfidence && hybridConfidence>=60){
   priority.innerHTML="ðŸŽ¯ PRIORITY â†’ Play COLOUR only";
   priority.style.background="darkred";
 }
 else if(sizeConfidence>colorConfidence && hybridConfidence>=60){
   priority.innerHTML="ðŸŽ¯ PRIORITY â†’ Play SIZE only";
   priority.style.background="darkblue";
 }
 else{
   priority.innerHTML="âš  Weak Signal â†’ Skip Round";
   priority.style.background="#555";
 }

}

</script>
</body>
</html>
<!DOCTYPE html>
<html>
<head>
<title>Short Term Ultra Colour Engine</title>
<style>
body{background:#111;color:#fff;font-family:Arial;text-align:center}
button{width:55px;height:55px;margin:4px;font-size:18px;border-radius:8px;border:none;cursor:pointer}
.controlBtn{width:120px;background:#444;color:white}
.meter{width:300px;height:20px;background:#333;border-radius:10px;margin:10px auto;overflow:hidden}
.fill{height:100%;width:0%;line-height:20px;font-size:12px;font-weight:bold}
#priority{margin-top:15px;font-size:18px;padding:10px;border-radius:8px}
</style>
</head>
<body>

<h2>SHORT TERM ULTRA ENGINE (15 Window)</h2>

<div id="buttons"></div>
<br>
<button class="controlBtn" onclick="undo()">UNDO</button>
<button class="controlBtn" onclick="resetAll()">RESET</button>

<div id="history"></div>
<div id="result"></div>

<h3>Confidence</h3>
<div class="meter"><div id="confidenceBar" class="fill"></div></div>

<div id="priority"></div>

<script>

let history=[];
const MAX_HISTORY=15;

function getColor(n){
 if(n==0||n==5) return "Violet";
 if([1,3,7,9].includes(n)) return "Green";
 return "Red";
}

for(let i=0;i<=9;i++){
 let b=document.createElement("button");
 b.innerText=i;
 b.onclick=()=>addNumber(i);
 document.getElementById("buttons").appendChild(b);
}

function addNumber(n){
 history.push(n);
 if(history.length>MAX_HISTORY){
   history.shift(); // remove oldest automatically
 }
 updateDisplay();
 analyze();
}

function undo(){
 if(history.length>0){
   history.pop();
   updateDisplay();
   analyze();
 }
}

function resetAll(){
 history=[];
 document.getElementById("history").innerHTML="";
 document.getElementById("result").innerHTML="";
 document.getElementById("priority").innerHTML="";
 document.getElementById("confidenceBar").style.width="0%";
}

function updateDisplay(){
 document.getElementById("history").innerText=
 history.length>0?"History (Last 15): "+history.join(", "):"History Empty";
}

function analyze(){

 if(history.length<8){
   document.getElementById("result").innerText="Need minimum 8 results...";
   return;
 }

 let votes={Red:0,Green:0,Violet:0};
 let recent=history.map(getColor);
 let last=recent[recent.length-1];

 // ===== RULE 1: FAST STREAK REVERSAL =====
 let streak=1;
 for(let i=recent.length-2;i>=0;i--){
   if(recent[i]==last) streak++;
   else break;
 }
 if(streak>=3){
   let reverse= last=="Red"?"Green":
                last=="Green"?"Red":"Red";
   votes[reverse]+=3;
 }

 // ===== RULE 2: MICRO MOMENTUM (last 6) =====
 let last6=recent.slice(-6);
 let red6=last6.filter(x=>x=="Red").length;
 let green6=last6.filter(x=>x=="Green").length;

 if(red6>=4) votes["Green"]+=2;
 if(green6>=4) votes["Red"]+=2;

 // ===== RULE 3: SHORT WINDOW DOMINANCE (last 10) =====
 let last10=recent.slice(-10);
 let red10=last10.filter(x=>x=="Red").length;
 let green10=last10.filter(x=>x=="Green").length;

 if(red10>green10) votes["Red"]+=1;
 if(green10>red10) votes["Green"]+=1;

 // ===== RULE 4: TRANSITION BIAS =====
 let transitions={Red:0,Green:0,Violet:0};
 for(let i=1;i<recent.length;i++){
   if(recent[i-1]==last){
     transitions[recent[i]]++;
   }
 }
 let probable=Object.keys(transitions)
   .reduce((a,b)=>transitions[a]>transitions[b]?a:b);
 votes[probable]+=2;

 // ===== RULE 5: VIOLET GAP SHORT =====
 let gap=0;
 for(let i=recent.length-1;i>=0;i--){
   if(recent[i]=="Violet") break;
   gap++;
 }
 if(gap>=7) votes["Violet"]+=3;

 // ===== RULE 6: VOLATILITY FILTER =====
 let unique=new Set(last6);
 if(unique.size==1){
   let reverse= last=="Red"?"Green":"Red";
   votes[reverse]+=3;
 }

 // ===== FINAL =====
 let final=Object.keys(votes)
   .reduce((a,b)=>votes[a]>votes[b]?a:b);

 let totalVotes=votes.Red+votes.Green+votes.Violet;
 let confidence= totalVotes>0 ?
   Math.round((votes[final]/totalVotes)*100) : 0;

 document.getElementById("result").innerHTML=
 "<br>Next Prediction: <b>"+final+"</b><br>"+
 "Confidence: "+confidence+"%";

 let bar=document.getElementById("confidenceBar");
 bar.style.width=confidence+"%";
 bar.innerText=confidence+"%";
 bar.style.background=
 final=="Red"?"red":
 final=="Green"?"green":"purple";

 let priority=document.getElementById("priority");
 if(confidence>=75){
   priority.innerHTML="ðŸ”¥ Strong Short-Term Signal â†’ Play "+final;
   priority.style.background="darkgreen";
 }
 else if(confidence>=60){
   priority.innerHTML="âš¡ Medium Signal â†’ Controlled Entry";
   priority.style.background="orange";
 }
 else{
   priority.innerHTML="âš  Weak Signal â†’ Skip";
   priority.style.background="#555";
 }

}

</script>
</body>
</html>
